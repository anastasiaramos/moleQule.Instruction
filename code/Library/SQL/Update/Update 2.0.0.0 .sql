/* UPDATE 2.0.0.0*/

SET SEARCH_PATH = "COMMON";

INSERT INTO "Variable" ("NAME", "VALUE") VALUES ('INSTRUCCION_SERIE', '1');
INSERT INTO "Variable" ("NAME", "VALUE") VALUES ('INSTRUCCION_PRODUCTO', '1');

SET SEARCH_PATH = "0001";

ALTER TABLE "PlantillaExamen" ADD COLUMN "NOMBRE" varchar;
ALTER TABLE "Empleado" DROP COLUMN "OID_IMPUESTO";
ALTER TABLE "Empleado" ADD COLUMN "OID_IMPUESTO" bigint DEFAULT 1;


CREATE TABLE "Concepto_Parte"
( 
	"OID" bigserial NOT NULL,	
	"OID_CONCEPTO" int8 NOT NULL,
	"OID_PARTE" int8 NOT NULL,
	CONSTRAINT "Concepto_Parte_PK" PRIMARY KEY ("OID")
) WITHOUT OIDS;

ALTER TABLE "Concepto_Parte" OWNER TO hangar_admin;
GRANT ALL ON TABLE "Concepto_Parte" TO GROUP "HANGAR_ADMINISTRADOR";

ALTER TABLE "Concepto_Parte" ADD  CONSTRAINT fk_concepto_parte_concepto 
FOREIGN KEY ("OID_CONCEPTO") REFERENCES "ConceptoAlbaranProveedor" ("OID") MATCH SIMPLE 
ON UPDATE CASCADE ON DELETE CASCADE;	

ALTER TABLE "Concepto_Parte" ADD  CONSTRAINT fk_concepto_parte_parte 
FOREIGN KEY ("OID_PARTE") REFERENCES "ParteAsistencia" ("OID") MATCH SIMPLE 
ON UPDATE CASCADE ON DELETE CASCADE;	

ALTER TABLE "Empleado" ADD COLUMN "CUENTA_ASOCIADA" varchar(255);

ALTER TABLE "ParteAsistencia" ADD COLUMN "CONFIRMADA" boolean DEFAULT false;

ALTER TABLE "ParteAsistencia" ADD COLUMN "OID_INSTRUCTOR_EFECTIVO" int8 DEFAULT 0;

UPDATE "ParteAsistencia" SET "OID_INSTRUCTOR_EFECTIVO" = "OID_INSTRUCTOR" WHERE "OID_INSTRUCTOR_EFECTIVO" = 0;




