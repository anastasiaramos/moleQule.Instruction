/* UPDATE 4.6.0.0*/

SET SEARCH_PATH = "COMMON";

UPDATE "Variable" SET "VALUE" = '4.6.0.0' WHERE "NAME" = 'INSTRUCTION_DB_VERSION';

DELETE FROM "Variable" WHERE "NAME" = 'INSTRUCCION_SERIE';
DELETE FROM "Variable" WHERE "NAME" = 'INSTRUCCION_PRODUCTO';

SET SEARCH_PATH = "0001";

ALTER TABLE "PlanEstudios" ADD COLUMN "OID_PRODUCTO" bigint NOT NULL DEFAULT 1;
ALTER TABLE "PlanEstudios" ADD COLUMN "OID_SERIE" bigint NOT NULL DEFAULT 1;
ALTER TABLE "PlanExtra" ADD COLUMN "OID_PRODUCTO" bigint NOT NULL DEFAULT 1;
ALTER TABLE "PlanExtra" ADD COLUMN "OID_SERIE" bigint NOT NULL DEFAULT 1;

ALTER TABLE "PlanEstudios" ADD CONSTRAINT "fk_PLAN_ESTUDIOS_PRODUCTO"
	FOREIGN KEY ("OID_PRODUCTO") REFERENCES "Producto" ("OID") 
	MATCH SIMPLE ON UPDATE CASCADE;

ALTER TABLE "PlanEstudios" ADD CONSTRAINT "fk_PLAN_ESTUDIOS_SERIE"
	FOREIGN KEY ("OID_SERIE") REFERENCES "COMMON"."Serie" ("OID") 
	MATCH SIMPLE ON UPDATE CASCADE;

ALTER TABLE "PlanExtra" ADD CONSTRAINT "fk_PLAN_EXTRA_PRODUCTO"
	FOREIGN KEY ("OID_PRODUCTO") REFERENCES "Producto" ("OID") 
	MATCH SIMPLE ON UPDATE CASCADE;

ALTER TABLE "PlanExtra" ADD CONSTRAINT "fk_PLAN_EXTRA_SERIE"
	FOREIGN KEY ("OID_SERIE") REFERENCES "COMMON"."Serie" ("OID") 
	MATCH SIMPLE ON UPDATE CASCADE;
